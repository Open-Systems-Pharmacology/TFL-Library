<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="tlf">
<title>Box-whisker plots • tlf</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Box-whisker plots">
<meta property="og:description" content="tlf">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">tlf</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/tlf.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/atom-plots.html">Atom plots</a>
    <a class="dropdown-item" href="../articles/box-whisker-vignette.html">Box-whisker plots</a>
    <a class="dropdown-item" href="../articles/histogram.html">Histogram plots</a>
    <a class="dropdown-item" href="../articles/pk-ratio-vignette.html">PK Ratio plots</a>
    <a class="dropdown-item" href="../articles/plot-configuration.html">Introduction to PlotConfiguration objects</a>
    <a class="dropdown-item" href="../articles/plot-maker.html">plot-maker</a>
    <a class="dropdown-item" href="../articles/plot-time-profile.html">Time Profile plots</a>
    <a class="dropdown-item" href="../articles/theme-maker.html">theme-maker</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/open-systems-pharmacology/tlf-library/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Box-whisker plots</h1>
                        <h4 data-toc-skip class="author">OSPSuiteR
2021</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/open-systems-pharmacology/tlf-library/blob/HEAD/vignettes/box-whisker-vignette.Rmd" class="external-link"><code>vignettes/box-whisker-vignette.Rmd</code></a></small>
      <div class="d-none name"><code>box-whisker-vignette.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/open-systems-pharmacology/tlf-library" class="external-link">tlf</a></span><span class="op">)</span>
<span class="co">#&gt; Loading required package: tlf</span></code></pre></div>
<div class="section level2">
<h2 id="introduction">1. Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The following vignette aims at documenting and illustrating workflows
for producing box-and-whisker plots using the
<code>tlf</code>-Library.</p>
<p>This vignette focuses boxplot examples. Detailed documentation on
typical <code>tlf</code> workflow, use of
<code>AgregationSummary</code>, <code>DataMapping</code>,
<code>PlotConfiguration</code> and <code>Theme</code> can be found in
<code>vignette("tlf-workflow")</code>.</p>
</div>
<div class="section level2">
<h2 id="definition-of-the-boxplot-fonctions-and-classes">2. Definition of the boxplot fonctions and classes<a class="anchor" aria-label="anchor" href="#definition-of-the-boxplot-fonctions-and-classes"></a>
</h2>
<div class="section level3">
<h3 id="the-plotboxwhisker-function">2.1. The <code>plotBoxWhisker</code> function<a class="anchor" aria-label="anchor" href="#the-plotboxwhisker-function"></a>
</h3>
<p>The function for plotting box-whiskers is:
<code>plotBoxWhisker</code>. Basic documentation of the function can be
found using: <code><a href="../reference/plotBoxWhisker.html">?plotBoxWhisker</a></code>. The typical usage of this
function is:
<code>plotBoxWhisker(data, metaData = NULL, dataMapping = NULL, plotConfiguration = NULL)</code>.
The output of the function is a <code>ggplot</code> object.</p>
</div>
<div class="section level3">
<h3 id="the-boxwhiskerdatamapping-class">2.2. The <code>BoxWhiskerDataMapping</code> class<a class="anchor" aria-label="anchor" href="#the-boxwhiskerdatamapping-class"></a>
</h3>
<p>The <code>dataMapping</code> from <code>plotBoxWhisker</code>
requires a <code>BoxWhiskerDataMapping</code> class. This class can
simply be initialized by <code>BoxWhiskerDataMapping$new()</code>,
needing <code>y</code> variable name input only. For boxplots with
multiple boxes, <code>x</code> variable name and/or <code>fill</code>
groupMapping can be used. The <code>x</code> variable is expected to be
factor levels. Beside these common input, it is possible to overwrite
the aggregation functions that plot the edges of the box, the whiskers
and the outlying data.</p>
<ul>
<li>For the box edges <code>lower</code>, <code>middle</code>, and
<code>upper</code> correspond to the first quartile, median, and the
third quartile (25th, 50th, and 75th percentiles), respectively.</li>
<li>For the whiskers, <code>ymin</code> and <code>ymax</code> use the
5th and 95th percentiles.</li>
<li>For outliers, points lower than the 25th percentile - 1.5 x IQR and
points higher than 75th percentile + 1.5 x IQR (where IQR is the
inter-quartile range) are flagged and plotted.</li>
</ul>
<p>In order to help with the boxplot aggregation functions, a bank of
predefined function names is already available in the tlfStatFunctions
(as an enum). Consequently, a tree with the available predefined
function names will appear when writing <code>tlfStatFunctions$</code>:
‘mean’, ‘sd’, ‘min’, ‘max’, ‘mean-sd’, ‘mean+sd’, ‘mean-1.96sd’,
‘mean+1.96sd’, ‘Percentile0%’, ‘Percentile1%’, ‘Percentile2.5%’,
‘Percentile5%’, ‘Percentile10%’, ‘Percentile15%’, ‘Percentile20%’,
‘Percentile25%’, ‘Percentile50%’, ‘Percentile75%’, ‘Percentile80%’,
‘Percentile85%’, ‘Percentile90%’, ‘Percentile95%’, ‘Percentile97.5%’,
‘Percentile99%’, ‘Percentile100%’, ‘median-IQR’, ‘median+IQR’,
‘median-1.5IQR’, ‘median+1.5IQR’, ‘Percentile25%-1.5IQR’,
‘Percentile75%+1.5IQR’,</p>
</div>
</div>
<div class="section level2">
<h2 id="examples">3. Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<div class="section level3">
<h3 id="data">3.1. Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h3>
<p>To illustrate the workflow to produce boxplots, let’s use the
<code>pkRatioDataExample.RData</code> example data from the
<code>extdata</code> folder.</p>
<p>It includes the dataset <code>pkRatioData</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load example</span>
<span class="va">pkRatioData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"test-data.csv"</span>, package <span class="op">=</span> <span class="st">"tlf"</span><span class="op">)</span>,
  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span>

<span class="co"># pkRatioData</span>
<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pkRatioData</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">ID</th>
<th align="right">Age</th>
<th align="right">Obs</th>
<th align="right">Pred</th>
<th align="right">Ratio</th>
<th align="left">AgeBin</th>
<th align="left">Sex</th>
<th align="left">Country</th>
<th align="right">SD</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">48</td>
<td align="right">4.00</td>
<td align="right">2.90</td>
<td align="right">0.72</td>
<td align="left">Adults</td>
<td align="left">Male</td>
<td align="left">Canada</td>
<td align="right">0.69</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">36</td>
<td align="right">4.40</td>
<td align="right">5.75</td>
<td align="right">1.31</td>
<td align="left">Adults</td>
<td align="left">Male</td>
<td align="left">Canada</td>
<td align="right">0.19</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">52</td>
<td align="right">2.80</td>
<td align="right">2.70</td>
<td align="right">0.96</td>
<td align="left">Adults</td>
<td align="left">Male</td>
<td align="left">Canada</td>
<td align="right">0.98</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">47</td>
<td align="right">3.75</td>
<td align="right">3.05</td>
<td align="right">0.81</td>
<td align="left">Adults</td>
<td align="left">Male</td>
<td align="left">Canada</td>
<td align="right">0.59</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">0</td>
<td align="right">1.95</td>
<td align="right">5.25</td>
<td align="right">2.69</td>
<td align="left">Peds</td>
<td align="left">Male</td>
<td align="left">Canada</td>
<td align="right">0.44</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">48</td>
<td align="right">2.45</td>
<td align="right">5.30</td>
<td align="right">2.16</td>
<td align="left">Adults</td>
<td align="left">Male</td>
<td align="left">Canada</td>
<td align="right">0.07</td>
</tr>
</tbody>
</table>
<p>We will also need to prepare a corresponding metaData
<code>pkRatioMetaData</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load example</span>
<span class="va">pkRatioMetaData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
  Age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
    dimension <span class="op">=</span> <span class="st">"Age"</span>,
    unit <span class="op">=</span> <span class="st">"yrs"</span>
  <span class="op">)</span>,
  Obs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
    dimension <span class="op">=</span> <span class="st">"Clearance"</span>,
    unit <span class="op">=</span> <span class="st">"dL/h/kg"</span>
  <span class="op">)</span>,
  Pred <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
    dimension <span class="op">=</span> <span class="st">"Clearance"</span>,
    unit <span class="op">=</span> <span class="st">"dL/h/kg"</span>
  <span class="op">)</span>,
  Ratio <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
    dimension <span class="op">=</span> <span class="st">"Ratio"</span>,
    unit <span class="op">=</span> <span class="st">""</span>
  <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>
  Variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Age"</span>, <span class="st">"Obs"</span>, <span class="st">"Pred"</span>, <span class="st">"Ratio"</span><span class="op">)</span>,
  Dimension <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Age"</span>, <span class="st">"Clearance"</span>, <span class="st">"Clearance"</span>, <span class="st">"Ratio"</span><span class="op">)</span>,
  Unit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"yrs"</span>, <span class="st">"dL/h/kg"</span>, <span class="st">"dL/h/kg"</span>, <span class="st">""</span><span class="op">)</span>
<span class="op">)</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Variable</th>
<th align="left">Dimension</th>
<th align="left">Unit</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Age</td>
<td align="left">Age</td>
<td align="left">yrs</td>
</tr>
<tr class="even">
<td align="left">Obs</td>
<td align="left">Clearance</td>
<td align="left">dL/h/kg</td>
</tr>
<tr class="odd">
<td align="left">Pred</td>
<td align="left">Clearance</td>
<td align="left">dL/h/kg</td>
</tr>
<tr class="even">
<td align="left">Ratio</td>
<td align="left">Ratio</td>
<td align="left"></td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="minimal-example">3.2. Minimal example<a class="anchor" aria-label="anchor" href="#minimal-example"></a>
</h3>
<p>In the minimal example, only the basic <code>y</code> variable name
is indicated. Here, <code>"Age"</code> was chosen for the boxplot.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">minMap</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/BoxWhiskerDataMapping.html">BoxWhiskerDataMapping</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Age"</span><span class="op">)</span>

<span class="va">minBoxplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotBoxWhisker.html">plotBoxWhisker</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">pkRatioData</span>,
  metaData <span class="op">=</span> <span class="va">pkRatioMetaData</span>,
  dataMapping <span class="op">=</span> <span class="va">minMap</span>
<span class="op">)</span>
<span class="va">minBoxplot</span></code></pre></div>
<p><img src="box-whisker-vignette_files/figure-html/minimal%20example-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="difference-x-vs-fill-input">3.3. Difference <code>x</code> vs <code>fill</code> input<a class="anchor" aria-label="anchor" href="#difference-x-vs-fill-input"></a>
</h3>
<p>In this plot, <code>x</code> and/or <code>fill</code> can be
provided. If only <code>x</code> is provided, the plot will use the
<code>x</code> variable for aggregation and the boxplots will be
displayed according to <code>x</code>. If providing <code>fill</code>,
the plot will use the <code>fill</code> groupMapping for aggregation and
the boxplots will be displayed around the same <code>x</code> but
comparing the color filling. Consequently, the <code>fill</code>
variable is useful when performing a double comparison.</p>
<p>In the example below, <code>"Country"</code> and <code>"Sex"</code>
can both be used for comparison of <code>"Age"</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">xPopMap</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/BoxWhiskerDataMapping.html">BoxWhiskerDataMapping</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>
  x <span class="op">=</span> <span class="st">"Country"</span>,
  y <span class="op">=</span> <span class="st">"Age"</span>
<span class="op">)</span>

<span class="va">xSexMap</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/BoxWhiskerDataMapping.html">BoxWhiskerDataMapping</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>
  x <span class="op">=</span> <span class="st">"Sex"</span>,
  y <span class="op">=</span> <span class="st">"Age"</span>
<span class="op">)</span>

<span class="va">fillPopMap</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/BoxWhiskerDataMapping.html">BoxWhiskerDataMapping</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>
  y <span class="op">=</span> <span class="st">"Age"</span>,
  fill <span class="op">=</span> <span class="st">"Country"</span>
<span class="op">)</span>

<span class="va">fillSexMap</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/BoxWhiskerDataMapping.html">BoxWhiskerDataMapping</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>
  y <span class="op">=</span> <span class="st">"Age"</span>,
  fill <span class="op">=</span> <span class="st">"Sex"</span>
<span class="op">)</span>
<span class="va">xPopFillSexMap</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/BoxWhiskerDataMapping.html">BoxWhiskerDataMapping</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>
  x <span class="op">=</span> <span class="st">"Country"</span>,
  y <span class="op">=</span> <span class="st">"Age"</span>,
  fill <span class="op">=</span> <span class="st">"Sex"</span>
<span class="op">)</span>

<span class="va">xSexFillPopMap</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/BoxWhiskerDataMapping.html">BoxWhiskerDataMapping</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>
  x <span class="op">=</span> <span class="st">"Sex"</span>,
  y <span class="op">=</span> <span class="st">"Age"</span>,
  fill <span class="op">=</span> <span class="st">"Country"</span>
<span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotBoxWhisker.html">plotBoxWhisker</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">pkRatioData</span>,
  metaData <span class="op">=</span> <span class="va">pkRatioMetaData</span>,
  dataMapping <span class="op">=</span> <span class="va">xPopMap</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="box-whisker-vignette_files/figure-html/boxplot-country%20x-1.png" alt="Boxplot mapping Country as x" width="100%"><p class="caption">
Boxplot mapping Country as x
</p>
</div>
<p>Note that the sample from a given country sometimes did not have any
individual from one of the sexes.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotBoxWhisker.html">plotBoxWhisker</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">pkRatioData</span>,
  metaData <span class="op">=</span> <span class="va">pkRatioMetaData</span>,
  dataMapping <span class="op">=</span> <span class="va">xSexMap</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="box-whisker-vignette_files/figure-html/boxplot-sex-x-1.png" alt="Boxplot mapping Sex as x" width="100%"><p class="caption">
Boxplot mapping Sex as x
</p>
</div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotBoxWhisker.html">plotBoxWhisker</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">pkRatioData</span>,
  metaData <span class="op">=</span> <span class="va">pkRatioMetaData</span>,
  dataMapping <span class="op">=</span> <span class="va">fillPopMap</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="box-whisker-vignette_files/figure-html/boxplot-country-fill-1.png" alt="Boxplot mapping Country as fill" width="100%"><p class="caption">
Boxplot mapping Country as fill
</p>
</div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotBoxWhisker.html">plotBoxWhisker</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">pkRatioData</span>,
  metaData <span class="op">=</span> <span class="va">pkRatioMetaData</span>,
  dataMapping <span class="op">=</span> <span class="va">fillSexMap</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="box-whisker-vignette_files/figure-html/boxplot-sex-fill-1.png" alt="Boxplot mapping Sex as fill" width="100%"><p class="caption">
Boxplot mapping Sex as fill
</p>
</div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotBoxWhisker.html">plotBoxWhisker</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">pkRatioData</span>,
  metaData <span class="op">=</span> <span class="va">pkRatioMetaData</span>,
  dataMapping <span class="op">=</span> <span class="va">xPopFillSexMap</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="box-whisker-vignette_files/figure-html/boxplot-country-x-sex-fill-1.png" alt="Boxplot mapping Country as x and Sex as fill" width="100%"><p class="caption">
Boxplot mapping Country as x and Sex as fill
</p>
</div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotBoxWhisker.html">plotBoxWhisker</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">pkRatioData</span>,
  metaData <span class="op">=</span> <span class="va">pkRatioMetaData</span>,
  dataMapping <span class="op">=</span> <span class="va">xSexFillPopMap</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="box-whisker-vignette_files/figure-html/boxplot-country-fill-sex-x-1.png" alt="Boxplot mapping Sex as x and Country as fill" width="100%"><p class="caption">
Boxplot mapping Sex as x and Country as fill
</p>
</div>
</div>
<div class="section level3">
<h3 id="boxplot-functions">3.4. Boxplot functions<a class="anchor" aria-label="anchor" href="#boxplot-functions"></a>
</h3>
<p>In some cases, displaying 5th and 95th percentiles is not necessary.
For instance, when a normal distribution is assumed, mean +/- 1.96
standard deviation would be preferred. In these cases, it is easy to
overwrite the default functions by specifying either using a home made
function or directly using predefined functions as suggested in section
2.2.</p>
<p>In the following examples, the boxplot will use the mean for the
middle line and mean +/- 1.96 standard deviation for the whiskers:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">normMap</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/BoxWhiskerDataMapping.html">BoxWhiskerDataMapping</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>
  x <span class="op">=</span> <span class="st">"Country"</span>,
  y <span class="op">=</span> <span class="st">"Age"</span>,
  fill <span class="op">=</span> <span class="st">"Sex"</span>,
  ymin <span class="op">=</span> <span class="va">tlfStatFunctions</span><span class="op">$</span><span class="va">`mean-1.96sd`</span>,
  middle <span class="op">=</span> <span class="va">tlfStatFunctions</span><span class="op">$</span><span class="va">mean</span>,
  ymax <span class="op">=</span> <span class="va">tlfStatFunctions</span><span class="op">$</span><span class="va">`mean+1.96sd`</span>
<span class="op">)</span>

<span class="va">normBoxplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotBoxWhisker.html">plotBoxWhisker</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">pkRatioData</span>,
  metaData <span class="op">=</span> <span class="va">pkRatioMetaData</span>,
  dataMapping <span class="op">=</span> <span class="va">normMap</span>
<span class="op">)</span>
<span class="va">normBoxplot</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="box-whisker-vignette_files/figure-html/aggregation-functions-1-1.png" alt="Boxplot mapping Country as x, Sex as fill and assuming normal distribution" width="100%"><p class="caption">
Boxplot mapping Country as x, Sex as fill and assuming normal
distribution
</p>
</div>
<p>In this example, the boxplot use also mean +/- standard deviation for
the box edges</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">normMap2</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/BoxWhiskerDataMapping.html">BoxWhiskerDataMapping</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>
  x <span class="op">=</span> <span class="st">"Country"</span>,
  y <span class="op">=</span> <span class="st">"Age"</span>,
  fill <span class="op">=</span> <span class="st">"Sex"</span>,
  ymin <span class="op">=</span> <span class="va">tlfStatFunctions</span><span class="op">$</span><span class="va">`mean-1.96sd`</span>,
  lower <span class="op">=</span> <span class="va">tlfStatFunctions</span><span class="op">$</span><span class="va">`mean-sd`</span>,
  middle <span class="op">=</span> <span class="va">tlfStatFunctions</span><span class="op">$</span><span class="va">mean</span>,
  upper <span class="op">=</span> <span class="va">tlfStatFunctions</span><span class="op">$</span><span class="va">`mean+sd`</span>,
  ymax <span class="op">=</span> <span class="va">tlfStatFunctions</span><span class="op">$</span><span class="va">`mean+1.96sd`</span>
<span class="op">)</span>

<span class="va">normBoxplot2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotBoxWhisker.html">plotBoxWhisker</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">pkRatioData</span>,
  metaData <span class="op">=</span> <span class="va">pkRatioMetaData</span>,
  dataMapping <span class="op">=</span> <span class="va">normMap2</span>
<span class="op">)</span>
<span class="va">normBoxplot2</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="box-whisker-vignette_files/figure-html/aggregation-functions-2-1.png" alt="Boxplot mapping Country as x, Sex as fill and assuming normal distribution" width="100%"><p class="caption">
Boxplot mapping Country as x, Sex as fill and assuming normal
distribution
</p>
</div>
<p><strong>Important</strong>: If you override the defaults this way,
please make sure to specify this in the plot annotations as you are
basically redefining a boxplot and the reader might not be aware of this
and will misinterpret the plot.</p>
</div>
<div class="section level3">
<h3 id="outlier-functions">3.5. Outlier functions<a class="anchor" aria-label="anchor" href="#outlier-functions"></a>
</h3>
<p>Default outliers are flagged when outside the range from 25th
percentiles - 1.5 x IQR to 75th percentiles + 1.5 x IQR, as suggested by
McGill and implemented by the current boxplot functions from ggplot
(<code>geom_boxplot</code>). However, these default can also be
overridden.</p>
<p>In the following example, outliers will be flagged when values are
out of the 10th-90th percentiles, while whiskers will go until these
same percentiles:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">outlierMap</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/BoxWhiskerDataMapping.html">BoxWhiskerDataMapping</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>
  x <span class="op">=</span> <span class="st">"Country"</span>,
  y <span class="op">=</span> <span class="st">"Age"</span>,
  fill <span class="op">=</span> <span class="st">"Sex"</span>,
  ymin <span class="op">=</span> <span class="va">tlfStatFunctions</span><span class="op">$</span><span class="va">`Percentile10%`</span>,
  ymax <span class="op">=</span> <span class="va">tlfStatFunctions</span><span class="op">$</span><span class="va">`Percentile90%`</span>,
  minOutlierLimit <span class="op">=</span> <span class="va">tlfStatFunctions</span><span class="op">$</span><span class="va">`Percentile10%`</span>,
  maxOutlierLimit <span class="op">=</span> <span class="va">tlfStatFunctions</span><span class="op">$</span><span class="va">`Percentile90%`</span>
<span class="op">)</span>

<span class="va">outlierBoxplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotBoxWhisker.html">plotBoxWhisker</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">pkRatioData</span>,
  metaData <span class="op">=</span> <span class="va">pkRatioMetaData</span>,
  dataMapping <span class="op">=</span> <span class="va">outlierMap</span>
<span class="op">)</span>
<span class="va">outlierBoxplot</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="box-whisker-vignette_files/figure-html/outlier-function-1.png" alt="Boxplot mapping Country as x, Sex as fill and assuming normal distribution" width="100%"><p class="caption">
Boxplot mapping Country as x, Sex as fill and assuming normal
distribution
</p>
</div>
</div>
<div class="section level3">
<h3 id="plotconfiguration-of-boxplots-boxwhiskerplotconfiguration">3.4. plotConfiguration of boxplots:
<code>BoxWhiskerPlotConfiguration</code><a class="anchor" aria-label="anchor" href="#plotconfiguration-of-boxplots-boxwhiskerplotconfiguration"></a>
</h3>
<p>To define the properties of the boxes and points of the box whisker
plots, a <em>BoxWhiskerPlotConfiguration</em> object can be defined to
overwrite the default properties. The <em>ribbons</em> and
<em>points</em> fields will define how the boxes and outliers will be
handled.</p>
<p>Using the previous example where country was defined in
<code>x</code> and gender as <code>color</code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Define a PlotConfiguration object using smart mapping</span>
<span class="va">boxplotConfiguration</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/BoxWhiskerPlotConfiguration.html">BoxWhiskerPlotConfiguration</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">pkRatioData</span>,
  metaData <span class="op">=</span> <span class="va">pkRatioMetaData</span>,
  dataMapping <span class="op">=</span> <span class="va">xPopFillSexMap</span>
<span class="op">)</span>

<span class="co"># Change the properties of the box colors</span>
<span class="va">boxplotConfiguration</span><span class="op">$</span><span class="va">ribbons</span><span class="op">$</span><span class="va">fill</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pink"</span>, <span class="st">"dodgerblue"</span><span class="op">)</span>
<span class="va">boxplotConfiguration</span><span class="op">$</span><span class="va">ribbons</span><span class="op">$</span><span class="va">color</span> <span class="op">&lt;-</span> <span class="st">"orange"</span>

<span class="co"># Change the properties of the points (outliers)</span>
<span class="va">boxplotConfiguration</span><span class="op">$</span><span class="va">points</span><span class="op">$</span><span class="va">size</span> <span class="op">&lt;-</span> <span class="fl">2</span>
<span class="va">boxplotConfiguration</span><span class="op">$</span><span class="va">points</span><span class="op">$</span><span class="va">shape</span> <span class="op">&lt;-</span> <span class="va">Shapes</span><span class="op">$</span><span class="va">diamond</span>

<span class="fu"><a href="../reference/plotBoxWhisker.html">plotBoxWhisker</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">pkRatioData</span>,
  metaData <span class="op">=</span> <span class="va">pkRatioMetaData</span>,
  dataMapping <span class="op">=</span> <span class="va">xPopFillSexMap</span>,
  plotConfiguration <span class="op">=</span> <span class="va">boxplotConfiguration</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="box-whisker-vignette_files/figure-html/boxplot-update-configuration-1.png" alt="Boxplot with updated plot configuration" width="100%"><p class="caption">
Boxplot with updated plot configuration
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="further-utility-of-boxwhiskerdatamapping">4. Further utility of <code>BoxWhiskerDataMapping</code><a class="anchor" aria-label="anchor" href="#further-utility-of-boxwhiskerdatamapping"></a>
</h2>
<p>Since the boxplot data mapping performs an aggregation of the data,
it possible to get directly the resulting aggregated statistic as a
table using <code>getBoxWhiskerLimits()</code>. Similarly, it can be
used to flag any values out of a certain range using
<code>getOutliers()</code>.</p>
<p>For instance, using the example from section 3.5, one can get the
following results</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">boxplotSummary</span> <span class="op">&lt;-</span> <span class="va">outlierMap</span><span class="op">$</span><span class="fu">getBoxWhiskerLimits</span><span class="op">(</span><span class="va">pkRatioData</span><span class="op">)</span>

<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">boxplotSummary</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Country</th>
<th align="left">Sex</th>
<th align="right">ymin</th>
<th align="right">lower</th>
<th align="right">middle</th>
<th align="right">upper</th>
<th align="right">ymax</th>
<th align="left">legendLabels</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">France</td>
<td align="left">Female</td>
<td align="right">16.5</td>
<td align="right">20.25</td>
<td align="right">26</td>
<td align="right">43.25</td>
<td align="right">53.1</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Germany</td>
<td align="left">Female</td>
<td align="right">8.8</td>
<td align="right">12.00</td>
<td align="right">37</td>
<td align="right">46.50</td>
<td align="right">52.2</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Canada</td>
<td align="left">Male</td>
<td align="right">2.8</td>
<td align="right">10.00</td>
<td align="right">34</td>
<td align="right">48.00</td>
<td align="right">54.2</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Germany</td>
<td align="left">Male</td>
<td align="right">1.0</td>
<td align="right">6.00</td>
<td align="right">28</td>
<td align="right">39.50</td>
<td align="right">49.0</td>
<td align="left"></td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">outliers</span> <span class="op">&lt;-</span> <span class="va">outlierMap</span><span class="op">$</span><span class="fu">getOutliers</span><span class="op">(</span><span class="va">pkRatioData</span><span class="op">)</span>
<span class="va">outliers</span> <span class="op">&lt;-</span> <span class="va">outliers</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Age"</span>, <span class="st">"minOutlierLimit"</span>, <span class="st">"maxOutlierLimit"</span>, <span class="st">"minOutliers"</span>, <span class="st">"maxOutliers"</span><span class="op">)</span><span class="op">]</span>

<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">outliers</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">Age</th>
<th align="right">minOutlierLimit</th>
<th align="right">maxOutlierLimit</th>
<th align="right">minOutliers</th>
<th align="right">maxOutliers</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">48</td>
<td align="right">2.8</td>
<td align="right">54.2</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">36</td>
<td align="right">2.8</td>
<td align="right">54.2</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">52</td>
<td align="right">2.8</td>
<td align="right">54.2</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">47</td>
<td align="right">2.8</td>
<td align="right">54.2</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">0</td>
<td align="right">2.8</td>
<td align="right">54.2</td>
<td align="right">0</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">48</td>
<td align="right">2.8</td>
<td align="right">54.2</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Michael Sevestre, Pierre Chelle, Abdullah Hamadeh.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.9000.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
